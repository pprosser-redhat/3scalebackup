apiVersion: v1
kind: Template
metadata:
  creationTimestamp: null
  name: project.yaml
objects:
- apiVersion: v1
  kind: BuildConfig
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      pipeline.alpha.openshift.io/uses: '[{"name": "ab-pipeline",  "kind": "DeploymentConfig"}]'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      name: ab-pipeline
      template: pipeline-ab
    name: ab-pipeline
  spec:
    failedBuildsHistoryLimit: 5
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    successfulBuildsHistoryLimit: 5
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0
- apiVersion: v1
  kind: BuildConfig
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      pipeline.alpha.openshift.io/uses: '[{"name": "allprod-pipeline",  "kind": "DeploymentConfig"}]'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      name: allprod-pipeline
      template: pipeline-allprod
    name: allprod-pipeline
  spec:
    failedBuildsHistoryLimit: 5
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    successfulBuildsHistoryLimit: 5
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0
- apiVersion: v1
  kind: BuildConfig
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      pipeline.alpha.openshift.io/uses: '[{"name": "play-area", "kind": "DeploymentConfig"}]'
    creationTimestamp: null
    labels:
      app: play-area
      name: play-area
      template: play-area
    name: play-area
  spec:
    failedBuildsHistoryLimit: 5
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                         def targetDeployConfig = openshift.selector( \"dc\",
          \"fisdemo/fisgateway-service\")\n                          \n                          def
          targetDeploy= targetDeployConfig.related('deployment')\n                          \n
          \                         targetDeployConfig.describe()\n                          targetDeploy.describe()\n
          \                         echo \"Current replicas = \"\n                          \n
          \                       }\n                    }\n                }\n            }\n
          \       }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace: \"fisdemo\", buildConfig:
          \"fisgateway-service\", showBuildLogs: \"true\")\n            \n    \n/*node('maven')
          { \n  stage('build') { \n    print 'build'\n     openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \ }           \n  stage('staging') {\n    print 'stage' \n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service\")\n  } \n  stage ('promotionCheck')
          { \n      def userInput = input( id: \"userInput\", message: \"Promote to
          UAT?\", parameters: [ [$class: \"TextParameterDefinition\", defaultValue:
          \"Comments?\", description: \"comments\", name: \"comments\"] ])  \n      print
          'promotionCheck' \n  \t\topenshiftTag(namespace: \"fisdemo\", sourceStream:
          \"fisgateway-service\",  sourceTag: \"latest\", destinationNamespace: \"fisdemo\",
          destinationStream: \"fisgateway-service\", destinationTag: \"uatready\")
          \  \n  } \n  \n  stage('UAT') { \n    print 'UAT'\n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    successfulBuildsHistoryLimit: 5
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0
- apiVersion: v1
  kind: BuildConfig
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      pipeline.alpha.openshift.io/uses: '[{"name": "uat-pipeline", "kind": "DeploymentConfig"}]'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      name: uat-pipeline
      template: pipeline-uat
    name: uat-pipeline
  spec:
    failedBuildsHistoryLimit: 5
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    successfulBuildsHistoryLimit: 5
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "142"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/wfapi/describe"}},"id":"4","name":"#4","status":"FAILED","startTimeMillis":1524744827895,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":235,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"FAILED","error":{"message":"hudson.AbortException:
        Unable to retrieve object names: selector([name=pods],[labels={deploymentconfig=fisgateway-service-new}],[namelist=null],[projectlist=null]);
        action failed: {reference={}, err=, verb=get, cmd=oc --server=https://172.30.0.1:443
        --certificate-authority=/var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        --namespace=fisdemoprod --token=XXXXX get pods -l deploymentconfig=fisgateway-service-new
        -o=name , out=, status=-1}","type":"java.util.concurrent.ExecutionException"},"startTimeMillis":1524744828130,"durationMillis":7743,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524744828430,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744828461,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744828467,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744828481,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744828488,"durationMillis":995,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744829483,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744829493,"durationMillis":1916,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744831409,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744831478,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744831500,"durationMillis":2381,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744833881,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744833891,"durationMillis":1926,"pauseDurationMillis":0,"parentNodes":["21"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/4/execution/node/32/wfapi/describe"}},"id":"32","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1524744835886,"durationMillis":11,"pauseDurationMillis":0,"stageFlowNodes":[]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-142
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "143"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1524745075473,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":5058,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1524745080531,"durationMillis":6402,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745082875,"durationMillis":84,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745083006,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745083017,"durationMillis":117,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745083134,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745083159,"durationMillis":908,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745084067,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745084085,"durationMillis":1422,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745085507,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745085595,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745085630,"durationMillis":298,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745085928,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745085940,"durationMillis":278,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745086218,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745086230,"durationMillis":292,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745086522,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745086534,"durationMillis":317,"pauseDurationMillis":0,"parentNodes":["25"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1524745086953,"durationMillis":802,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745087005,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/42/wfapi/describe"}},"id":"42","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745087016,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["41"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/43/wfapi/describe"}},"id":"43","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745087025,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745087040,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745087049,"durationMillis":274,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/46/wfapi/describe"}},"id":"46","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745087323,"durationMillis":84,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/47/wfapi/describe"}},"id":"47","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745087407,"durationMillis":52,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/48/wfapi/describe"}},"id":"48","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745087459,"durationMillis":274,"pauseDurationMillis":0,"parentNodes":["47"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-143
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "144"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/wfapi/describe"}},"id":"2","name":"#2","status":"SUCCESS","startTimeMillis":1524745092302,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":282,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1524745092584,"durationMillis":3395,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745092928,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745092970,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745092978,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745093001,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745093011,"durationMillis":300,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745093311,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745093322,"durationMillis":1379,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745094701,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745094772,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745094792,"durationMillis":280,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745095072,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745095084,"durationMillis":283,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745095367,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745095377,"durationMillis":277,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745095654,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745095664,"durationMillis":271,"pauseDurationMillis":0,"parentNodes":["25"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/36/wfapi/describe"}},"id":"36","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1524745095990,"durationMillis":683,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745096042,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/42/wfapi/describe"}},"id":"42","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745096055,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["41"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/43/wfapi/describe"}},"id":"43","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745096062,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745096075,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745096085,"durationMillis":271,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/46/wfapi/describe"}},"id":"46","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745096356,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/47/wfapi/describe"}},"id":"47","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745096369,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/2/execution/node/48/wfapi/describe"}},"id":"48","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745096380,"durationMillis":272,"pauseDurationMillis":0,"parentNodes":["47"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-144
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "145"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/wfapi/describe"}},"id":"3","name":"#3","status":"SUCCESS","startTimeMillis":1524747468355,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":219,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1524747468574,"durationMillis":36445,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747468893,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747468924,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747468930,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747468948,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747468957,"durationMillis":598,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747469555,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747469564,"durationMillis":1919,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747471483,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747471550,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747471569,"durationMillis":605,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747472174,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747472183,"durationMillis":1593,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747473776,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747473787,"durationMillis":1582,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747475369,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747475380,"durationMillis":1595,"pauseDurationMillis":0,"parentNodes":["25"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/27/wfapi/describe"}},"id":"27","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747476975,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["26"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/28/wfapi/describe"}},"id":"28","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747476986,"durationMillis":1593,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/29/wfapi/describe"}},"id":"29","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747478579,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747478593,"durationMillis":1591,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/31/wfapi/describe"}},"id":"31","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747480184,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/32/wfapi/describe"}},"id":"32","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747480196,"durationMillis":1593,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747481789,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747481800,"durationMillis":1594,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/35/wfapi/describe"}},"id":"35","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747483394,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/36/wfapi/describe"}},"id":"36","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747483403,"durationMillis":1582,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/37/wfapi/describe"}},"id":"37","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747484985,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/38/wfapi/describe"}},"id":"38","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747484993,"durationMillis":1583,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/39/wfapi/describe"}},"id":"39","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747486576,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/40/wfapi/describe"}},"id":"40","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747486584,"durationMillis":588,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/41/wfapi/describe"}},"id":"41","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747487172,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/42/wfapi/describe"}},"id":"42","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747487181,"durationMillis":588,"pauseDurationMillis":0,"parentNodes":["41"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/43/wfapi/describe"}},"id":"43","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747487769,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/44/wfapi/describe"}},"id":"44","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747487778,"durationMillis":589,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/47/wfapi/describe"}},"id":"47","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747488386,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/48/wfapi/describe"}},"id":"48","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747488394,"durationMillis":585,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/49/wfapi/describe"}},"id":"49","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747488979,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747488987,"durationMillis":584,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/51/wfapi/describe"}},"id":"51","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747489571,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/52/wfapi/describe"}},"id":"52","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747489586,"durationMillis":589,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/55/wfapi/describe"}},"id":"55","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747502034,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/56/wfapi/describe"}},"id":"56","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747502042,"durationMillis":964,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/57/wfapi/describe"}},"id":"57","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747503006,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/58/wfapi/describe"}},"id":"58","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747503018,"durationMillis":1385,"pauseDurationMillis":0,"parentNodes":["57"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/59/wfapi/describe"}},"id":"59","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747504403,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["58"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/60/wfapi/describe"}},"id":"60","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747504412,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["59"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/70/wfapi/describe"}},"id":"70","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1524747505028,"durationMillis":1266,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/75/wfapi/describe"}},"id":"75","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747505059,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["74"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/76/wfapi/describe"}},"id":"76","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747505065,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["75"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/77/wfapi/describe"}},"id":"77","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747505071,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["76"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/78/wfapi/describe"}},"id":"78","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747505082,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["77"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/79/wfapi/describe"}},"id":"79","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747505089,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["78"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/80/wfapi/describe"}},"id":"80","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747505669,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["79"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/81/wfapi/describe"}},"id":"81","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747505686,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["80"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/3/execution/node/82/wfapi/describe"}},"id":"82","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747505697,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["81"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-145
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "146"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1525289522738,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":306,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1525289523044,"durationMillis":20497,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289523445,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289523484,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289523491,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289523520,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289523530,"durationMillis":615,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289524145,"durationMillis":32,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289524177,"durationMillis":1933,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289526110,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289526209,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289526237,"durationMillis":577,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289526814,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289526823,"durationMillis":1989,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289528812,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289528822,"durationMillis":1401,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289530223,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289530242,"durationMillis":1419,"pauseDurationMillis":0,"parentNodes":["25"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/27/wfapi/describe"}},"id":"27","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289531661,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["26"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289531674,"durationMillis":960,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289532666,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289532680,"durationMillis":977,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289533657,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289533673,"durationMillis":1403,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289535076,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289535092,"durationMillis":1385,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289538726,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289538738,"durationMillis":1935,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289540673,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/42/wfapi/describe"}},"id":"42","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289540688,"durationMillis":1410,"pauseDurationMillis":0,"parentNodes":["41"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/43/wfapi/describe"}},"id":"43","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289542098,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289542111,"durationMillis":1392,"pauseDurationMillis":0,"parentNodes":["43"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/54/wfapi/describe"}},"id":"54","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1525289543552,"durationMillis":1422,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/59/wfapi/describe"}},"id":"59","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289543594,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["58"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/60/wfapi/describe"}},"id":"60","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289543601,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["59"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/61/wfapi/describe"}},"id":"61","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289543609,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["60"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/62/wfapi/describe"}},"id":"62","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289543622,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["61"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289543634,"durationMillis":582,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/64/wfapi/describe"}},"id":"64","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289544216,"durationMillis":73,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289544289,"durationMillis":70,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/66/wfapi/describe"}},"id":"66","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289544359,"durationMillis":589,"pauseDurationMillis":0,"parentNodes":["65"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-146
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "147"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1525343801310,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":671,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1525343801981,"durationMillis":111386,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343802352,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343802397,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343802406,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343802435,"durationMillis":24,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343802459,"durationMillis":1452,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343803911,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343803933,"durationMillis":2560,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343806493,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343806550,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343806573,"durationMillis":2567,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343809140,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343809153,"durationMillis":5224,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343814377,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343814388,"durationMillis":6310,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343820698,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343820712,"durationMillis":6281,"pauseDurationMillis":0,"parentNodes":["25"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/27/wfapi/describe"}},"id":"27","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343826993,"durationMillis":42,"pauseDurationMillis":0,"parentNodes":["26"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343827035,"durationMillis":5356,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/29/wfapi/describe"}},"id":"29","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343832391,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343832410,"durationMillis":5305,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343837715,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343837729,"durationMillis":5289,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343843040,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343843054,"durationMillis":5297,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343848351,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/38/wfapi/describe"}},"id":"38","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343848361,"durationMillis":5318,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343853679,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343853692,"durationMillis":5313,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/43/wfapi/describe"}},"id":"43","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343897306,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343897316,"durationMillis":5333,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343902649,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/46/wfapi/describe"}},"id":"46","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343902660,"durationMillis":5320,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/47/wfapi/describe"}},"id":"47","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343907980,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/48/wfapi/describe"}},"id":"48","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343907991,"durationMillis":5289,"pauseDurationMillis":0,"parentNodes":["47"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/58/wfapi/describe"}},"id":"58","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1525343913380,"durationMillis":2696,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343913431,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/64/wfapi/describe"}},"id":"64","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343913446,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343913459,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/66/wfapi/describe"}},"id":"66","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343913478,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["65"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/67/wfapi/describe"}},"id":"67","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343913504,"durationMillis":969,"pauseDurationMillis":0,"parentNodes":["66"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/68/wfapi/describe"}},"id":"68","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343914473,"durationMillis":82,"pauseDurationMillis":0,"parentNodes":["67"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/69/wfapi/describe"}},"id":"69","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343914555,"durationMillis":76,"pauseDurationMillis":0,"parentNodes":["68"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/70/wfapi/describe"}},"id":"70","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343914631,"durationMillis":1426,"pauseDurationMillis":0,"parentNodes":["69"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-147
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "149"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1528884727997,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":10511,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1528884738508,"durationMillis":66165,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884742986,"durationMillis":192,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884743266,"durationMillis":338,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884743604,"durationMillis":409,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884744013,"durationMillis":57,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884744070,"durationMillis":1254,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884745324,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884745352,"durationMillis":2680,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884748032,"durationMillis":99,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884748436,"durationMillis":62,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884748498,"durationMillis":821,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884749319,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884749354,"durationMillis":1514,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884750868,"durationMillis":50,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884750918,"durationMillis":1017,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884751935,"durationMillis":24,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884751959,"durationMillis":1160,"pauseDurationMillis":0,"parentNodes":["25"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/29/wfapi/describe"}},"id":"29","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884799867,"durationMillis":104,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884799971,"durationMillis":1497,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884801468,"durationMillis":157,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884801625,"durationMillis":1815,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884803440,"durationMillis":54,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884803494,"durationMillis":1007,"pauseDurationMillis":0,"parentNodes":["33"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1528884804703,"durationMillis":2744,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884804793,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884804807,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884804830,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884804853,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884804881,"durationMillis":1045,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/54/wfapi/describe"}},"id":"54","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884805926,"durationMillis":170,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/55/wfapi/describe"}},"id":"55","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884806096,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/56/wfapi/describe"}},"id":"56","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884806130,"durationMillis":636,"pauseDurationMillis":0,"parentNodes":["55"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-149
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.number: "150"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1529058717445,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":1108,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveToProd","execNode":"","status":"SUCCESS","startTimeMillis":1529058718553,"durationMillis":97063,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058719203,"durationMillis":86,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058719321,"durationMillis":24,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058719345,"durationMillis":83,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058719428,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058719458,"durationMillis":2553,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058722011,"durationMillis":27,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058722038,"durationMillis":2457,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058724495,"durationMillis":73,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058724920,"durationMillis":32,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058724952,"durationMillis":3146,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058728098,"durationMillis":89,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/22/wfapi/describe"}},"id":"22","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058728187,"durationMillis":4318,"pauseDurationMillis":0,"parentNodes":["21"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/23/wfapi/describe"}},"id":"23","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058732505,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["22"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058732539,"durationMillis":2921,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058735460,"durationMillis":36,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/26/wfapi/describe"}},"id":"26","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058735496,"durationMillis":3031,"pauseDurationMillis":0,"parentNodes":["25"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/27/wfapi/describe"}},"id":"27","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058738527,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["26"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058738562,"durationMillis":2012,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058740611,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058740634,"durationMillis":2678,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058743312,"durationMillis":52,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058743364,"durationMillis":2758,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058746122,"durationMillis":48,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058746170,"durationMillis":3165,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058805345,"durationMillis":41,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058805386,"durationMillis":3021,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058808407,"durationMillis":662,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/42/wfapi/describe"}},"id":"42","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058809069,"durationMillis":2851,"pauseDurationMillis":0,"parentNodes":["41"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/43/wfapi/describe"}},"id":"43","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058811920,"durationMillis":32,"pauseDurationMillis":0,"parentNodes":["42"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058811952,"durationMillis":3528,"pauseDurationMillis":0,"parentNodes":["43"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/54/wfapi/describe"}},"id":"54","name":"createABRoute","execNode":"","status":"SUCCESS","startTimeMillis":1529058815760,"durationMillis":4543,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/59/wfapi/describe"}},"id":"59","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058815891,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["58"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/60/wfapi/describe"}},"id":"60","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058815916,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["59"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/61/wfapi/describe"}},"id":"61","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058815946,"durationMillis":39,"pauseDurationMillis":0,"parentNodes":["60"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/62/wfapi/describe"}},"id":"62","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058815985,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["61"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058816015,"durationMillis":1497,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/64/wfapi/describe"}},"id":"64","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058817512,"durationMillis":299,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058817811,"durationMillis":171,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-ab-pipeline/1/execution/node/66/wfapi/describe"}},"id":"66","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058817982,"durationMillis":2261,"pauseDurationMillis":0,"parentNodes":["65"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-ab
      buildconfig: ab-pipeline
      name: ab-pipeline
      openshift.io/build-config.name: ab-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-ab
    name: ab-pipeline-150
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: ab-pipeline
      uid: 4fbcdbe4-1012-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n        stages {\n            stage('moveToProd'){\n
          \               steps {\n                    script{\n                        openshift.withCluster()
          {\n                            //openshift.verbose()\n                            openshift.withProject('fisdemoprod')
          {\n                                \n                                \n
          \                               // Make UAT version of the image available
          for AB testing\n                                openshift.tag(\"fisdemo/fisgateway-service:uatready\",
          \"fisdemoprod/fisgateway-service-new:latest\")\n                                \n
          \                               // Rollout lastest version\n                               //
          openshift.selector(\"dc\", \"fisgateway-service-new\").rollout().latest()\n
          \                               \n                                // Scale
          temp new version ready for AB testing\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=1\")\n                                \n
          \                               //Wait for pod  to become ready\n                                openshift.selector(\"dc\",
          \"fisgateway-service-new\").related('pods').untilEach(1) {\n                                  return
          (it.object().status.phase == \"Running\")\n                                }\n
          \                               \n                              // openshift.verbose(false)\n
          \                           }\n                        }\n                    }\n
          \               }\n            }\n            stage('createABRoute') {\n
          \               steps {\n                    script {\n                        def
          abroute = [\n                        \"apiVersion\": \"v1\",\n                        \"kind\":
          \"Route\",\n                        \"metadata\": [\n                            \"labels\":
          [\n                                'component': 'fisgateway-service-stable',\n
          \                               'group': 'quickstarts',\n                                'project':
          'fisgateway-service-stable',\n                                'provider':
          's2i',\n                                'template': 'fisgateway-service',\n
          \                               'version': '1.0.0'\n                            ],\n
          \                           \"name\": \"fisgateway-service\",\n                            \"namespace\":
          \"fisdemoprod\",\n                            \"annotations\" : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"alternateBackends\":
          [[\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-new\",\n                                \"weight\":
          30\n                            ]],\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                                \"weight\":
          70\n                            ],\n                        ]\n                    ]\n
          \                   \n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(abroute)\n
          \                       }\n                        \n                    }\n
          \               }\n            }\n            // To do, update 3Scale using
          the 3Scale API\n        }\n    }\n}\n\n/*\n  stage('moveToProd'){\n    echo
          \"UAT at ${env.uatnamespace} and PROD at ${env.prodnamespace}\"\n    openshiftTag
          alias: \"false\",  destStream: \"fisgateway-service\", destTag: \"latest\",
          destinationNamespace: \"${env.prodnamespace}\", namespace: \"${env.uatnamespace}\",
          srcStream: \"fisgateway-service-uat\", srcTag: \"uatready\", verbose: \"true\"\n
          \ }\n  \n  stage('StartNewServices') {\n    print 'Start new service with
          one pod running' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.prodnamespace}\", replicaCount: \"1\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('UpdateRouteToAB') { \n    print
          'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.prodnamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to both new and stable service'
          \n    openshiftCreateResource jsonyaml: \"{    'apiVersion': 'v1',    'kind':
          'Route',    'metadata': {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.prodnamespace}'    },    'spec': {        'alternateBackends':
          [            {                'kind': 'Service',                'name':
          'fisgateway-service-new',                'weight': 30            }        ],
          \       'host': 'fisgateway-service-temp.apps.mkt2go.com',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 70        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"temp\", verbose: \"false\"\n  }\n  \n  stage('GetCurrentLimitId')
          { \n    print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAB')
          { \n    print 'Update 3scale Limit back to AB Testing mode'  \n    sh  \"echo
          Updating Id ${env.LIMIT_ID} to less request ${env.ablimit} per min because
          of AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.ablimit}\\'\"
          \ \n  }\n}\n*/\n\n\n"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: ab-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "39"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/wfapi/describe"}},"id":"2","name":"#2","status":"SUCCESS","startTimeMillis":1524733278581,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":215,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524733278796,"durationMillis":37481,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524733279070,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733279111,"durationMillis":5,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733279116,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733279130,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733279138,"durationMillis":595,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733279733,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733279741,"durationMillis":586,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733280327,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733280335,"durationMillis":35905,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524733316288,"durationMillis":1285,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733316326,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733316333,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524733316340,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733316355,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733316364,"durationMillis":574,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524733316938,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733316961,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733316986,"durationMillis":571,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1524733317582,"durationMillis":1951,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733317610,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733317616,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524733317632,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524733317639,"durationMillis":1876,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-39
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "40"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1524745201847,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":255,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524745202102,"durationMillis":28260,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745202420,"durationMillis":27,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745202461,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745202468,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745202487,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745202498,"durationMillis":607,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745203105,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745203117,"durationMillis":281,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745203398,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745203419,"durationMillis":26908,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524745230372,"durationMillis":1031,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745230410,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745230417,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745230428,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745230444,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745230470,"durationMillis":275,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524745230745,"durationMillis":46,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745230791,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745230804,"durationMillis":578,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1524745231414,"durationMillis":1488,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745231460,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745231471,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524745231488,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524745231499,"durationMillis":1371,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-40
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "41"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/wfapi/describe"}},"id":"2","name":"#2","status":"SUCCESS","startTimeMillis":1524747525618,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":222,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524747525840,"durationMillis":28395,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747526127,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747526164,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747526180,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747526205,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747526216,"durationMillis":607,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747526823,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747526832,"durationMillis":593,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747527425,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747527434,"durationMillis":26774,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1524747554243,"durationMillis":1307,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747554277,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747554289,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747554297,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747554308,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747554316,"durationMillis":575,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747554891,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747554912,"durationMillis":27,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747554939,"durationMillis":590,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1524747555560,"durationMillis":2000,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747555604,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747555612,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747555625,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/2/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747555634,"durationMillis":1899,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-41
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "42"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1525289659112,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":353,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1525289659465,"durationMillis":28962,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289660150,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289660201,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289660210,"durationMillis":33,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289660243,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289660255,"durationMillis":997,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289661252,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289661262,"durationMillis":968,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289662230,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289662242,"durationMillis":26152,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1525289688437,"durationMillis":2070,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289688480,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289688499,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289688507,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289688522,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289688534,"durationMillis":968,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289689502,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289689524,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289689540,"durationMillis":943,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1525289690517,"durationMillis":2035,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289690572,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289690578,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289690596,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289690606,"durationMillis":1910,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-42
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "43"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1525344131499,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":603,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1525344132102,"durationMillis":31184,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525344132617,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344132662,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344132684,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344132704,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344132718,"durationMillis":1960,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344134678,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344134689,"durationMillis":1408,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344136097,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344136108,"durationMillis":27136,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1525344163297,"durationMillis":3523,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344163331,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344163338,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525344163347,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344163360,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344163370,"durationMillis":1406,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525344164776,"durationMillis":45,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344164821,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344164844,"durationMillis":1944,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1525344166834,"durationMillis":2692,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344166888,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344166897,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525344166918,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525344166933,"durationMillis":2570,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-43
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "45"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1528884918712,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":1204,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1528884919916,"durationMillis":33483,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884920474,"durationMillis":65,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884920561,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884920573,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884920596,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884920608,"durationMillis":1072,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884921680,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884921699,"durationMillis":1017,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884922716,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884922738,"durationMillis":30608,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1528884953415,"durationMillis":1376,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884953461,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884953478,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884953488,"durationMillis":36,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884953524,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884953535,"durationMillis":596,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528884954131,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884954151,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884954166,"durationMillis":598,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1528884954802,"durationMillis":2063,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884954854,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884954862,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528884954881,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884954896,"durationMillis":1902,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-45
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.number: "46"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1529058837481,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":1930,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"moveNewToStable","execNode":"","status":"SUCCESS","startTimeMillis":1529058839411,"durationMillis":70092,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058840510,"durationMillis":56,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058840590,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058840601,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058840635,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058840650,"durationMillis":1539,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058842189,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058842214,"durationMillis":2593,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/16/wfapi/describe"}},"id":"16","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058844807,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["15"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/17/wfapi/describe"}},"id":"17","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058844837,"durationMillis":64500,"pauseDurationMillis":0,"parentNodes":["16"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"UpdateRouteToStable","execNode":"","status":"SUCCESS","startTimeMillis":1529058909640,"durationMillis":4743,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058909898,"durationMillis":27,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058909925,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058909960,"durationMillis":47,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058910007,"durationMillis":43,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/34/wfapi/describe"}},"id":"34","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058910050,"durationMillis":1469,"pauseDurationMillis":0,"parentNodes":["33"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/35/wfapi/describe"}},"id":"35","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058911519,"durationMillis":42,"pauseDurationMillis":0,"parentNodes":["34"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058911561,"durationMillis":43,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058911604,"durationMillis":2728,"pauseDurationMillis":0,"parentNodes":["36"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"StopNewServices","execNode":"","status":"SUCCESS","startTimeMillis":1529058914410,"durationMillis":4241,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/50/wfapi/describe"}},"id":"50","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058914510,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["49"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/51/wfapi/describe"}},"id":"51","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058914528,"durationMillis":44,"pauseDurationMillis":0,"parentNodes":["50"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058914572,"durationMillis":565,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-allprod-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058915137,"durationMillis":3286,"pauseDurationMillis":0,"parentNodes":["52"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-allprod
      buildconfig: allprod-pipeline
      name: allprod-pipeline
      openshift.io/build-config.name: allprod-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-allprod
    name: allprod-pipeline-46
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: allprod-pipeline
      uid: 815147a1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('moveNewToStable')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemoprod') {\n                            \n
          \                           openshift.tag(\"fisdemoprod/fisgateway-service-new:latest\",
          \"fisdemoprod/fisgateway-service-stable:latest\")\n                            \n
          \                           def deploymentConfig = openshift.selector(\"dc\",
          \"fisgateway-service-stable\")\n                            \n                            def
          rm = deploymentConfig.rollout()\n                            \n                            //Rollout
          latest deployment\n                            rm.latest()\n                            \n
          \                           //Check Rollout status - blocks and waits for
          rollout to complete\n                            rm.status()\n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('UpdateRouteToStable') {\n            steps {\n                script
          {\n                    def stableroute = [\n                        \"apiVersion\":
          \"v1\",\n                        \"kind\": \"Route\",\n                        \"metadata\":
          [\n                            \"labels\": [\n                                'component':
          'fisgateway-service-stable',\n                                'group': 'quickstarts',\n
          \                               'project': 'fisgateway-service-stable',\n
          \                               'provider': 's2i',\n                                'template':
          'fisgateway-service',\n                                'version': '1.0.0'\n
          \                           ],\n                            \"name\": \"fisgateway-service\",\n
          \                           \"namespace\": \"fisdemoprod\",\n                            \"annotations\"
          : [\n                                'haproxy.router.openshift.io/balance':
          'roundrobin'\n                                ],\n                            ],\n
          \                       \"spec\": [\n                            \"host\":
          \"fisgateway-service-fisdemoprod.apps.demolab.local\",\n                            \"to\":
          [\n                                \"kind\": \"Service\",\n                                \"name\":
          \"fisgateway-service-stable\",\n                            ],\n                        ]\n
          \                   ]\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                                \n                            echo \"Deleting
          existing route\"\n                            \n                            openshift.selector(\"route\",
          \"fisgateway-service\").delete()\n                            \n                            echo
          \"Creating Route\"\n                            def objs = openshift.create(stableroute)\n
          \                               \n                            \n                        }
          \  \n                    }\n                }\n            }\n        }\n
          \       stage ('StopNewServices') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemoprod')
          {\n                            \n                            // stop the
          new deployment pods until next time!\n                            openshift.selector(\"dc\",
          \"fisgateway-service-new\").scale(\"--replicas=0\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        } \n    }\n}\n\n/*node('maven')
          { \n  env.threescaleurl = \"https://fusedemo-admin.3scale.net\";\n  env.apiaccesstoken
          = \"143d1a90ea5d369a88ec35310f06b86fec8569a1c34c21eaffc9f9906947962a\";
          \   \n  env.appplanid = \"2357355899471\";\n  env.metricsid = \"2555418019263\";\n
          \ env.normallimit = 50;\n  \n  env.newnamespace = \"fisdemoprod\";\n  env.stablenamespace
          = \"fisdemoprod\";\n  \n  stage('moveNewToStable') { \n    print 'Move new
          image stream to stable image stream' \n    openshiftTag(namespace: \"${env.newnamespace}\",
          sourceStream: \"fisgateway-service\",  sourceTag: \"latest\", destinationnamespace:
          \"${env.stablenamespace}\", destinationStream: \"fisgateway-service-stable\",
          destinationTag: \"latest\")\n  }\n  \n  stage('UpdateRouteToStable') {\n
          \   print 'deleteroute' \n    openshiftDeleteResourceByKey keys: \"fisgateway-service\",
          namespace: \"${env.stablenamespace}\", types: \"route\", verbose: \"true\"\n
          \   \n    print 'Update Route to only point to stable service' \n    openshiftCreateResource
          jsonyaml: \"{    'apiVersion': 'v1',    'kind': 'Route',    'metadata':
          {        'labels': {            'component': 'fisgateway-service-stable',
          \           'group': 'quickstarts',            'project': 'fisgateway-service-stable',
          \           'provider': 's2i',            'template': 'fisgateway-service',
          \           'version': '1.0.0'        },        'name': 'fisgateway-service',
          \       'namespace': '${env.stablenamespace}'    },    'spec': {        'host':
          'fisgateway-service-${env.stablenamespace}.192.168.64.2.nip.io',        'to':
          {            'kind': 'Service',            'name': 'fisgateway-service-stable',
          \           'weight': 100        },        'wildcardPolicy': 'None'    }}\",
          namespace: \"${env.stablenamespace}\", verbose: \"false\"\n  } \n  \n  stage('StopNewServices')
          {\n    print 'Stop all new service pod' \n    openshiftScale depCfg: \"fisgateway-service-new\",
          namespace: \"${env.newnamespace}\", replicaCount: \"0\", verifyReplicaCount:
          \"true\", verbose: \"true\"\n  }\n  \n  stage('GetCurrentLimitId') { \n
          \   print 'Get Current Limit Id'\n    env.LIMIT_ID = sh (\n      script:
          \"curl --silent -X GET \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits.xml?access_token=${env.apiaccesstoken}\\\"
          --stderr - | sed -e 's,.*<id>\\\\([^<]*\\\\)</id>.*,\\\\1,g' \", \n      returnStdout:
          true\n    ).trim()\n    echo env.LIMIT_ID\n  }\n  \n  stage('UpdateLimitToAllProd')
          { \n    print 'Update 3scale Limit back to normal'\n    sh  \"echo Updating
          Id ${env.LIMIT_ID} to less request ${env.normallimit} per min because of
          AB Testing\"\n    sh  \"curl -s -o /dev/null -w \\\"%{http_code}\\\\n\\\"
          -X PUT  \\\"${env.threescaleurl}/admin/api/application_plans/${env.appplanid}/metrics/${env.metricsid}/limits/${env.LIMIT_ID}.xml\\\"
          -d \\'access_token=${env.apiaccesstoken}&period=minute&value=${env.normallimit}\\'\"
          \ \n  }\n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: allprod-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: play-area
      openshift.io/build.number: "14"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/wfapi/describe"},"changesets":null,"pendingInputActions":null,"nextPendingInputAction":null,"artifacts":null},"id":"14","name":"#14","status":"SUCCESS","startTimeMillis":1519399372364,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":6589,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/4/wfapi/describe"},"log":null},"id":"4","name":"build","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399378953,"durationMillis":31707,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/7/wfapi/describe"},"log":null},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399384272,"durationMillis":1951,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/10/wfapi/describe"},"log":null},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399388488,"durationMillis":720,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/11/wfapi/describe"},"log":null},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399389208,"durationMillis":2783,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/12/wfapi/describe"},"log":null},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399391991,"durationMillis":972,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/13/wfapi/describe"},"log":null},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399392963,"durationMillis":17666,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/14/execution/node/14/wfapi/describe"},"log":null},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519399410629,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["13"]}],"allChildNodeIds":["5","6","7","8","9","10","11","12","13","14","15","16","17","18"]}]}'
    creationTimestamp: null
    labels:
      app: play-area
      buildconfig: play-area
      name: play-area
      openshift.io/build-config.name: play-area
      openshift.io/build.start-policy: Serial
      template: play-area
    name: play-area-14
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: play-area
      uid: 313a0e5c-18a8-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                         def targetDeployConfig = openshift.selector( \"dc\",
          \"fisgateway-service\")\n                          \n                          def
          targetDeploy= targetDeployConfig.related('deployment')\n                          \n
          \                         targetDeploy.describe()\n                          \n
          \                         echo \"Current replicas = \"\n                          \n
          \                       }\n                    }\n                }\n            }\n
          \       }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace: \"fisdemo\", buildConfig:
          \"fisgateway-service\", showBuildLogs: \"true\")\n            \n    \n/*node('maven')
          { \n  stage('build') { \n    print 'build'\n     openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \ }           \n  stage('staging') {\n    print 'stage' \n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service\")\n  } \n  stage ('promotionCheck')
          { \n      def userInput = input( id: \"userInput\", message: \"Promote to
          UAT?\", parameters: [ [$class: \"TextParameterDefinition\", defaultValue:
          \"Comments?\", description: \"comments\", name: \"comments\"] ])  \n      print
          'promotionCheck' \n  \t\topenshiftTag(namespace: \"fisdemo\", sourceStream:
          \"fisgateway-service\",  sourceTag: \"latest\", destinationNamespace: \"fisdemo\",
          destinationStream: \"fisgateway-service\", destinationTag: \"uatready\")
          \  \n  } \n  \n  stage('UAT') { \n    print 'UAT'\n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: play-area
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: play-area
      openshift.io/build.number: "2"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/wfapi/describe"},"changesets":null,"pendingInputActions":null,"nextPendingInputAction":null,"artifacts":null},"id":"2","name":"#2","status":"SUCCESS","startTimeMillis":1519398350316,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":207,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/execution/node/4/wfapi/describe"},"log":null},"id":"4","name":"build","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398350523,"durationMillis":484,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/execution/node/7/wfapi/describe"},"log":null},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398350914,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/execution/node/10/wfapi/describe"},"log":null},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398350953,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/execution/node/11/wfapi/describe"},"log":null},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398350959,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/2/execution/node/12/wfapi/describe"},"log":null},"id":"12","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398350987,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["11"]}],"allChildNodeIds":["5","6","7","8","9","10","11","12","13","14","15","16"]}]}'
    creationTimestamp: null
    labels:
      app: play-area
      buildconfig: play-area
      name: play-area
      openshift.io/build-config.name: play-area
      openshift.io/build.start-policy: Serial
      template: play-area
    name: play-area-2
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: play-area
      uid: 313a0e5c-18a8-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                         def targetDeployConfig = openshift.selector( \"dc\",
          \"fisgateway-service\")\n                          \n                          def
          targetDeploy= targetDeployConfig.related('deployment')\n                          \n
          \                         echo ' Current replicas = {$targetDeploy.Replicas}'\n
          \                         \n                        }\n                    }\n
          \               }\n            }\n        }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: play-area
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: play-area
      openshift.io/build.number: "4"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/wfapi/describe"},"changesets":null,"pendingInputActions":null,"nextPendingInputAction":null,"artifacts":null},"id":"4","name":"#4","status":"SUCCESS","startTimeMillis":1519398491261,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":148,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/execution/node/4/wfapi/describe"},"log":null},"id":"4","name":"build","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398491409,"durationMillis":516,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/execution/node/7/wfapi/describe"},"log":null},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398491834,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/execution/node/10/wfapi/describe"},"log":null},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398491871,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/execution/node/11/wfapi/describe"},"log":null},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398491877,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/4/execution/node/12/wfapi/describe"},"log":null},"id":"12","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398491907,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["11"]}],"allChildNodeIds":["5","6","7","8","9","10","11","12","13","14","15","16"]}]}'
    creationTimestamp: null
    labels:
      app: play-area
      buildconfig: play-area
      name: play-area
      openshift.io/build-config.name: play-area
      openshift.io/build.start-policy: Serial
      template: play-area
    name: play-area-4
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: play-area
      uid: 313a0e5c-18a8-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                         def targetDeployConfig = openshift.selector( \"dc\",
          \"fisgateway-service\")\n                          \n                          def
          targetDeploy= targetDeployConfig.related('deployment')\n                          \n
          \                         echo ' Current replicas = ${targetDeploy}'\n                          \n
          \                       }\n                    }\n                }\n            }\n
          \       }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace: \"fisdemo\", buildConfig:
          \"fisgateway-service\", showBuildLogs: \"true\")\n            \n    \n/*node('maven')
          { \n  stage('build') { \n    print 'build'\n     openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \ }           \n  stage('staging') {\n    print 'stage' \n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service\")\n  } \n  stage ('promotionCheck')
          { \n      def userInput = input( id: \"userInput\", message: \"Promote to
          UAT?\", parameters: [ [$class: \"TextParameterDefinition\", defaultValue:
          \"Comments?\", description: \"comments\", name: \"comments\"] ])  \n      print
          'promotionCheck' \n  \t\topenshiftTag(namespace: \"fisdemo\", sourceStream:
          \"fisgateway-service\",  sourceTag: \"latest\", destinationNamespace: \"fisdemo\",
          destinationStream: \"fisgateway-service\", destinationTag: \"uatready\")
          \  \n  } \n  \n  stage('UAT') { \n    print 'UAT'\n    openshiftDeploy(namespace:
          \"fisdemo\", deploymentConfig: \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: play-area
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: play-area
      openshift.io/build.number: "8"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/wfapi/describe"},"changesets":null,"pendingInputActions":null,"nextPendingInputAction":null,"artifacts":null},"id":"8","name":"#8","status":"SUCCESS","startTimeMillis":1519398713904,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":153,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/execution/node/4/wfapi/describe"},"log":null},"id":"4","name":"build","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398714057,"durationMillis":482,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/execution/node/7/wfapi/describe"},"log":null},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398714455,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/execution/node/10/wfapi/describe"},"log":null},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398714485,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/execution/node/11/wfapi/describe"},"log":null},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398714491,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-play-area/8/execution/node/12/wfapi/describe"},"log":null},"id":"12","name":"Print
        Message","execNode":"","status":"SUCCESS","error":null,"startTimeMillis":1519398714520,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["11"]}],"allChildNodeIds":["5","6","7","8","9","10","11","12","13","14","15","16"]}]}'
    creationTimestamp: null
    labels:
      app: play-area
      buildconfig: play-area
      name: play-area
      openshift.io/build-config.name: play-area
      openshift.io/build.start-policy: Serial
      template: play-area
    name: play-area-8
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: play-area
      uid: 313a0e5c-18a8-11e8-91ce-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                         def targetDeployConfig = openshift.selector( \"dc\",
          \"fisgateway-service\")\n                          \n                          def
          targetDeploy= targetDeployConfig.related('deployment')\n                          \n
          \                         echo \"Current replicas = ${targetDeploy}\"\n
          \                         \n                        }\n                    }\n
          \               }\n            }\n        }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: play-area
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "156"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/wfapi/describe"}},"id":"4","name":"#4","status":"SUCCESS","startTimeMillis":1524732400460,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":617,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1524732401077,"durationMillis":59164,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524732401560,"durationMillis":37,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732401611,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732401617,"durationMillis":46,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732401663,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732401679,"durationMillis":579,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524732402258,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732402271,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732402333,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732402356,"durationMillis":586,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732402942,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732402960,"durationMillis":949,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524732403927,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732403941,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732403977,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732403989,"durationMillis":964,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732404953,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732404967,"durationMillis":601,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732405568,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732405594,"durationMillis":585,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732406210,"durationMillis":36,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732406246,"durationMillis":968,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732407214,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732407223,"durationMillis":620,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732407843,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732407854,"durationMillis":582,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732409542,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732409553,"durationMillis":965,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732410518,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732410527,"durationMillis":612,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732411139,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732411149,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732458027,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732458038,"durationMillis":960,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732458998,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732459010,"durationMillis":594,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732459604,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732459615,"durationMillis":585,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/60/wfapi/describe"}},"id":"60","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524732460216,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["59"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/68/wfapi/describe"}},"id":"68","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1524732460252,"durationMillis":86470,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/73/wfapi/describe"}},"id":"73","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732460287,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["72"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/74/wfapi/describe"}},"id":"74","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732460296,"durationMillis":39,"pauseDurationMillis":0,"parentNodes":["73"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/75/wfapi/describe"}},"id":"75","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732460335,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["74"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/76/wfapi/describe"}},"id":"76","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732460360,"durationMillis":588,"pauseDurationMillis":0,"parentNodes":["75"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/77/wfapi/describe"}},"id":"77","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732460948,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["76"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/78/wfapi/describe"}},"id":"78","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732460957,"durationMillis":85747,"pauseDurationMillis":0,"parentNodes":["77"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/86/wfapi/describe"}},"id":"86","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1524732546732,"durationMillis":202849,"pauseDurationMillis":202142,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/91/wfapi/describe"}},"id":"91","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732546770,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["90"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/92/wfapi/describe"}},"id":"92","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732546776,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["91"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/93/wfapi/describe"}},"id":"93","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1524732546792,"durationMillis":202153,"pauseDurationMillis":202142,"parentNodes":["92"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/94/wfapi/describe"}},"id":"94","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524732748945,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["93"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/95/wfapi/describe"}},"id":"95","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732748955,"durationMillis":606,"pauseDurationMillis":0,"parentNodes":["94"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/103/wfapi/describe"}},"id":"103","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1524732749590,"durationMillis":55,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/108/wfapi/describe"}},"id":"108","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732749617,"durationMillis":5,"pauseDurationMillis":0,"parentNodes":["107"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/4/execution/node/109/wfapi/describe"}},"id":"109","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524732749622,"durationMillis":5,"pauseDurationMillis":0,"parentNodes":["108"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-156
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    revision:
      git:
        author: {}
        committer: {}
      type: Git
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - githubWebHook:
        revision:
          git:
            author: {}
            committer: {}
          type: Git
        secret: secr***
      message: GitHub WebHook
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "157"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/wfapi/describe"}},"id":"5","name":"#5","status":"SUCCESS","startTimeMillis":1524744483532,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":539,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1524744484071,"durationMillis":64232,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524744484528,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744484563,"durationMillis":5,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744484568,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744484603,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744484615,"durationMillis":950,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524744485565,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744485577,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744485622,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744485642,"durationMillis":598,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744486240,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744486257,"durationMillis":942,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524744487212,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744487224,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744487263,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744487278,"durationMillis":1038,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744488316,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744488334,"durationMillis":955,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744489289,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744489302,"durationMillis":1379,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744490699,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744490711,"durationMillis":954,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744491665,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744491675,"durationMillis":1388,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744493063,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744493073,"durationMillis":1381,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744494473,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744494483,"durationMillis":1390,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744495873,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744495883,"durationMillis":1393,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744497276,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744497287,"durationMillis":947,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744544505,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744544514,"durationMillis":1388,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744545902,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744545912,"durationMillis":1399,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744547311,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744547321,"durationMillis":944,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/60/wfapi/describe"}},"id":"60","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524744548283,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["59"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/68/wfapi/describe"}},"id":"68","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1524744548312,"durationMillis":66288,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/73/wfapi/describe"}},"id":"73","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744548341,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["72"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/74/wfapi/describe"}},"id":"74","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744548363,"durationMillis":29,"pauseDurationMillis":0,"parentNodes":["73"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/75/wfapi/describe"}},"id":"75","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744548392,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["74"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/76/wfapi/describe"}},"id":"76","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744548403,"durationMillis":592,"pauseDurationMillis":0,"parentNodes":["75"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/77/wfapi/describe"}},"id":"77","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744548995,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["76"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/78/wfapi/describe"}},"id":"78","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744549006,"durationMillis":65563,"pauseDurationMillis":0,"parentNodes":["77"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/86/wfapi/describe"}},"id":"86","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1524744614615,"durationMillis":96652,"pauseDurationMillis":95933,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/91/wfapi/describe"}},"id":"91","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744614688,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["90"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/92/wfapi/describe"}},"id":"92","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744614695,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["91"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/93/wfapi/describe"}},"id":"93","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1524744614717,"durationMillis":95937,"pauseDurationMillis":95933,"parentNodes":["92"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/94/wfapi/describe"}},"id":"94","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524744710654,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["93"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/95/wfapi/describe"}},"id":"95","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744710667,"durationMillis":578,"pauseDurationMillis":0,"parentNodes":["94"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/103/wfapi/describe"}},"id":"103","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1524744711277,"durationMillis":63,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/108/wfapi/describe"}},"id":"108","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744711306,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["107"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/5/execution/node/109/wfapi/describe"}},"id":"109","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524744711313,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["108"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-157
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    revision:
      git:
        author: {}
        committer: {}
      type: Git
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - githubWebHook:
        revision:
          git:
            author: {}
            committer: {}
          type: Git
        secret: secr***
      message: GitHub WebHook
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "158"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1524747193923,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":574,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1524747194497,"durationMillis":105151,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747194982,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747195020,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747195028,"durationMillis":49,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747195077,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747195088,"durationMillis":575,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747195663,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747195679,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747195736,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747195756,"durationMillis":281,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747196037,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747196052,"durationMillis":579,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747196647,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747196660,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747196698,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747196709,"durationMillis":587,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747197296,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747197311,"durationMillis":590,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747197901,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747197914,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747198522,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747198531,"durationMillis":586,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747199117,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747199127,"durationMillis":583,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747199710,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747199720,"durationMillis":577,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747238622,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747238633,"durationMillis":595,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747239228,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747239239,"durationMillis":601,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747239840,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747239858,"durationMillis":1039,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747244889,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747244910,"durationMillis":589,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747245499,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747245509,"durationMillis":600,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747246109,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747246123,"durationMillis":576,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/60/wfapi/describe"}},"id":"60","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747296063,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["59"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/61/wfapi/describe"}},"id":"61","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747296080,"durationMillis":1416,"pauseDurationMillis":0,"parentNodes":["60"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/62/wfapi/describe"}},"id":"62","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747297496,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["61"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747297510,"durationMillis":973,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/64/wfapi/describe"}},"id":"64","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747298483,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747298497,"durationMillis":1068,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/68/wfapi/describe"}},"id":"68","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1524747299599,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["67"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/76/wfapi/describe"}},"id":"76","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1524747299659,"durationMillis":37798,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/81/wfapi/describe"}},"id":"81","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747299699,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["80"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/82/wfapi/describe"}},"id":"82","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747299715,"durationMillis":31,"pauseDurationMillis":0,"parentNodes":["81"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/83/wfapi/describe"}},"id":"83","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747299746,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["82"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/84/wfapi/describe"}},"id":"84","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747299759,"durationMillis":944,"pauseDurationMillis":0,"parentNodes":["83"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/85/wfapi/describe"}},"id":"85","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747300703,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["84"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/86/wfapi/describe"}},"id":"86","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747300713,"durationMillis":36724,"pauseDurationMillis":0,"parentNodes":["85"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/94/wfapi/describe"}},"id":"94","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1524747337467,"durationMillis":62574,"pauseDurationMillis":61878,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/99/wfapi/describe"}},"id":"99","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747337507,"durationMillis":5,"pauseDurationMillis":0,"parentNodes":["98"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/100/wfapi/describe"}},"id":"100","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747337512,"durationMillis":33,"pauseDurationMillis":0,"parentNodes":["99"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/101/wfapi/describe"}},"id":"101","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1524747337545,"durationMillis":61887,"pauseDurationMillis":61878,"parentNodes":["100"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/102/wfapi/describe"}},"id":"102","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1524747399432,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["101"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/103/wfapi/describe"}},"id":"103","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747399443,"durationMillis":573,"pauseDurationMillis":0,"parentNodes":["102"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/111/wfapi/describe"}},"id":"111","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1524747400051,"durationMillis":66,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/116/wfapi/describe"}},"id":"116","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747400085,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["115"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/117/wfapi/describe"}},"id":"117","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1524747400091,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["116"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-158
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    revision:
      git:
        author: {}
        committer: {}
      type: Git
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - githubWebHook:
        revision:
          git:
            author: {}
            committer: {}
          type: Git
        secret: secr***
      message: GitHub WebHook
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "161"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/wfapi/describe"}},"id":"2","name":"#2","status":"SUCCESS","startTimeMillis":1525289194681,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":5659,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1525289200340,"durationMillis":125796,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289202818,"durationMillis":108,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289202955,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289202968,"durationMillis":173,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289203141,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289203164,"durationMillis":964,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289204128,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289204158,"durationMillis":48,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289204275,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289204300,"durationMillis":653,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289204953,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289204970,"durationMillis":1391,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289206411,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289206428,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289206493,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289206514,"durationMillis":593,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289207107,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289207141,"durationMillis":654,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289207795,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289207818,"durationMillis":582,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289208445,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289208457,"durationMillis":299,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289208756,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289208772,"durationMillis":286,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289209058,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289209073,"durationMillis":275,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289265188,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289265199,"durationMillis":589,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289265788,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289265805,"durationMillis":597,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289266402,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289266428,"durationMillis":279,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289266732,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289266748,"durationMillis":588,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289267336,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289267347,"durationMillis":295,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289267642,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289267654,"durationMillis":274,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/60/wfapi/describe"}},"id":"60","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289324900,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["59"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/61/wfapi/describe"}},"id":"61","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289324921,"durationMillis":576,"pauseDurationMillis":0,"parentNodes":["60"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/62/wfapi/describe"}},"id":"62","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289325497,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["61"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289325514,"durationMillis":272,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/64/wfapi/describe"}},"id":"64","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289325786,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/65/wfapi/describe"}},"id":"65","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289325796,"durationMillis":269,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/68/wfapi/describe"}},"id":"68","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525289326114,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["67"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/76/wfapi/describe"}},"id":"76","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1525289326150,"durationMillis":26158,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/81/wfapi/describe"}},"id":"81","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289326206,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["80"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/82/wfapi/describe"}},"id":"82","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289326214,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["81"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/83/wfapi/describe"}},"id":"83","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289326248,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["82"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/84/wfapi/describe"}},"id":"84","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289326260,"durationMillis":289,"pauseDurationMillis":0,"parentNodes":["83"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/85/wfapi/describe"}},"id":"85","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289326549,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["84"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/86/wfapi/describe"}},"id":"86","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289326575,"durationMillis":25709,"pauseDurationMillis":0,"parentNodes":["85"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/94/wfapi/describe"}},"id":"94","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1525289352320,"durationMillis":18501,"pauseDurationMillis":17800,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/99/wfapi/describe"}},"id":"99","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289352361,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["98"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/100/wfapi/describe"}},"id":"100","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289352369,"durationMillis":35,"pauseDurationMillis":0,"parentNodes":["99"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/101/wfapi/describe"}},"id":"101","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1525289352404,"durationMillis":17800,"pauseDurationMillis":17800,"parentNodes":["100"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/102/wfapi/describe"}},"id":"102","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525289370204,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["101"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/103/wfapi/describe"}},"id":"103","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289370215,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["102"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/111/wfapi/describe"}},"id":"111","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1525289370836,"durationMillis":84,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/116/wfapi/describe"}},"id":"116","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289370881,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["115"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/execution/node/117/wfapi/describe"}},"id":"117","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525289370888,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["116"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-161
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "162"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1525343140070,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":5076,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1525343145146,"durationMillis":92395,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343147489,"durationMillis":78,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343147594,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343147605,"durationMillis":166,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343147771,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343147793,"durationMillis":918,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343148711,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343148729,"durationMillis":18,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343148817,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343148851,"durationMillis":635,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343149486,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343149508,"durationMillis":578,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343150125,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343150144,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343150201,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343150215,"durationMillis":609,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343150824,"durationMillis":37,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343150861,"durationMillis":637,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343151498,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343151513,"durationMillis":580,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343152124,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343152135,"durationMillis":605,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343152740,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343152752,"durationMillis":592,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343153344,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343153356,"durationMillis":584,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343171669,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343171680,"durationMillis":961,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343172641,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343172656,"durationMillis":951,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343173607,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343173621,"durationMillis":587,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343174227,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343174239,"durationMillis":594,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343174833,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343174845,"durationMillis":962,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343175807,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343175819,"durationMillis":951,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/60/wfapi/describe"}},"id":"60","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343233149,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["59"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/61/wfapi/describe"}},"id":"61","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343233163,"durationMillis":1911,"pauseDurationMillis":0,"parentNodes":["60"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/62/wfapi/describe"}},"id":"62","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343235074,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["61"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/63/wfapi/describe"}},"id":"63","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343235087,"durationMillis":955,"pauseDurationMillis":0,"parentNodes":["62"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/64/wfapi/describe"}},"id":"64","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343236042,"durationMillis":32,"pauseDurationMillis":0,"parentNodes":["63"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343236074,"durationMillis":1389,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/68/wfapi/describe"}},"id":"68","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1525343237518,"durationMillis":3,"pauseDurationMillis":0,"parentNodes":["67"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/76/wfapi/describe"}},"id":"76","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1525343237558,"durationMillis":44538,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/81/wfapi/describe"}},"id":"81","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343237600,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["80"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/82/wfapi/describe"}},"id":"82","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343237607,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["81"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/83/wfapi/describe"}},"id":"83","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343237635,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["82"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/84/wfapi/describe"}},"id":"84","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343237646,"durationMillis":595,"pauseDurationMillis":0,"parentNodes":["83"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/85/wfapi/describe"}},"id":"85","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343238241,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["84"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/86/wfapi/describe"}},"id":"86","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343238256,"durationMillis":43812,"pauseDurationMillis":0,"parentNodes":["85"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/94/wfapi/describe"}},"id":"94","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1525343282117,"durationMillis":261552,"pauseDurationMillis":260458,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/99/wfapi/describe"}},"id":"99","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343282166,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["98"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/100/wfapi/describe"}},"id":"100","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343282174,"durationMillis":44,"pauseDurationMillis":0,"parentNodes":["99"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/101/wfapi/describe"}},"id":"101","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1525343282218,"durationMillis":260463,"pauseDurationMillis":260458,"parentNodes":["100"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/102/wfapi/describe"}},"id":"102","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1525343542681,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["101"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/103/wfapi/describe"}},"id":"103","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343542692,"durationMillis":944,"pauseDurationMillis":0,"parentNodes":["102"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/111/wfapi/describe"}},"id":"111","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1525343543680,"durationMillis":63,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/116/wfapi/describe"}},"id":"116","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343543712,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["115"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/117/wfapi/describe"}},"id":"117","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1525343543719,"durationMillis":6,"pauseDurationMillis":0,"parentNodes":["116"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-162
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    revision:
      git:
        author: {}
        committer: {}
      type: Git
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - githubWebHook:
        revision:
          git:
            author: {}
            committer: {}
          type: Git
        secret: secr***
      message: GitHub WebHook
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "163"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/wfapi/describe"}},"id":"1","name":"#1","status":"SUCCESS","startTimeMillis":1528883705879,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":5069,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1528883710948,"durationMillis":129223,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528883713093,"durationMillis":76,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883713200,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883713210,"durationMillis":149,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883713359,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883713380,"durationMillis":1995,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528883715375,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883715398,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883715522,"durationMillis":34,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883715556,"durationMillis":5781,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883721337,"durationMillis":37,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883721374,"durationMillis":10200,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528883731626,"durationMillis":82,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883731708,"durationMillis":37,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883731808,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883731824,"durationMillis":6636,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883738460,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883738481,"durationMillis":8235,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883746716,"durationMillis":68,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883746784,"durationMillis":8277,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883755089,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883755102,"durationMillis":8252,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883763354,"durationMillis":36,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883763390,"durationMillis":8219,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883771609,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883771625,"durationMillis":10030,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883803237,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883803251,"durationMillis":12237,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883815488,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883815502,"durationMillis":12267,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883827769,"durationMillis":15,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883827784,"durationMillis":12272,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/52/wfapi/describe"}},"id":"52","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1528883840142,"durationMillis":1,"pauseDurationMillis":0,"parentNodes":["51"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/60/wfapi/describe"}},"id":"60","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1528883840188,"durationMillis":32836,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/65/wfapi/describe"}},"id":"65","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883840246,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["64"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/66/wfapi/describe"}},"id":"66","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883840254,"durationMillis":36,"pauseDurationMillis":0,"parentNodes":["65"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/67/wfapi/describe"}},"id":"67","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883840290,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["66"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/68/wfapi/describe"}},"id":"68","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883840304,"durationMillis":1951,"pauseDurationMillis":0,"parentNodes":["67"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/69/wfapi/describe"}},"id":"69","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883842255,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["68"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/70/wfapi/describe"}},"id":"70","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883842269,"durationMillis":30724,"pauseDurationMillis":0,"parentNodes":["69"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/78/wfapi/describe"}},"id":"78","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1528883873045,"durationMillis":130428,"pauseDurationMillis":125005,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/83/wfapi/describe"}},"id":"83","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883873094,"durationMillis":7,"pauseDurationMillis":0,"parentNodes":["82"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/84/wfapi/describe"}},"id":"84","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883873101,"durationMillis":32,"pauseDurationMillis":0,"parentNodes":["83"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/85/wfapi/describe"}},"id":"85","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1528883873133,"durationMillis":125007,"pauseDurationMillis":125005,"parentNodes":["84"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/86/wfapi/describe"}},"id":"86","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1528883998140,"durationMillis":10,"pauseDurationMillis":0,"parentNodes":["85"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/87/wfapi/describe"}},"id":"87","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528883998150,"durationMillis":5298,"pauseDurationMillis":0,"parentNodes":["86"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/95/wfapi/describe"}},"id":"95","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1528884003490,"durationMillis":88,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/100/wfapi/describe"}},"id":"100","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884003535,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["99"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/1/execution/node/101/wfapi/describe"}},"id":"101","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1528884003544,"durationMillis":9,"pauseDurationMillis":0,"parentNodes":["100"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-163
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    revision:
      git:
        author: {}
        committer: {}
      type: Git
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - githubWebHook:
        revision:
          git:
            author: {}
            committer: {}
          type: Git
        secret: secr***
      message: GitHub WebHook
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "167"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/2/wfapi/describe"}},"id":"2","name":"#2","status":"NOT_EXECUTED","startTimeMillis":1529057562226,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":0,"pauseDurationMillis":0,"stages":[]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-167
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    cancelled: true
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "168"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/wfapi/describe"}},"id":"3","name":"#3","status":"SUCCESS","startTimeMillis":1529058470808,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":5256,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/4/wfapi/describe"}},"id":"4","name":"build","execNode":"","status":"SUCCESS","startTimeMillis":1529058476064,"durationMillis":83286,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/7/wfapi/describe"}},"id":"7","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058478443,"durationMillis":95,"pauseDurationMillis":0,"parentNodes":["6"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/10/wfapi/describe"}},"id":"10","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058478566,"durationMillis":11,"pauseDurationMillis":0,"parentNodes":["9"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/11/wfapi/describe"}},"id":"11","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058478577,"durationMillis":196,"pauseDurationMillis":0,"parentNodes":["10"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/12/wfapi/describe"}},"id":"12","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058478773,"durationMillis":25,"pauseDurationMillis":0,"parentNodes":["11"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/13/wfapi/describe"}},"id":"13","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058478798,"durationMillis":944,"pauseDurationMillis":0,"parentNodes":["12"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/14/wfapi/describe"}},"id":"14","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058479742,"durationMillis":31,"pauseDurationMillis":0,"parentNodes":["13"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/15/wfapi/describe"}},"id":"15","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058479773,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["14"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/18/wfapi/describe"}},"id":"18","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058479938,"durationMillis":31,"pauseDurationMillis":0,"parentNodes":["17"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/19/wfapi/describe"}},"id":"19","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058479969,"durationMillis":325,"pauseDurationMillis":0,"parentNodes":["18"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/20/wfapi/describe"}},"id":"20","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058480294,"durationMillis":17,"pauseDurationMillis":0,"parentNodes":["19"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/21/wfapi/describe"}},"id":"21","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058480311,"durationMillis":576,"pauseDurationMillis":0,"parentNodes":["20"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/24/wfapi/describe"}},"id":"24","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058480928,"durationMillis":22,"pauseDurationMillis":0,"parentNodes":["23"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/25/wfapi/describe"}},"id":"25","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058480950,"durationMillis":19,"pauseDurationMillis":0,"parentNodes":["24"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/28/wfapi/describe"}},"id":"28","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058481011,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["27"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/29/wfapi/describe"}},"id":"29","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058481032,"durationMillis":611,"pauseDurationMillis":0,"parentNodes":["28"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/30/wfapi/describe"}},"id":"30","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058481643,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["29"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/31/wfapi/describe"}},"id":"31","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058481671,"durationMillis":355,"pauseDurationMillis":0,"parentNodes":["30"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/32/wfapi/describe"}},"id":"32","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058482026,"durationMillis":31,"pauseDurationMillis":0,"parentNodes":["31"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/33/wfapi/describe"}},"id":"33","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058482057,"durationMillis":274,"pauseDurationMillis":0,"parentNodes":["32"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/36/wfapi/describe"}},"id":"36","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058482364,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["35"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/37/wfapi/describe"}},"id":"37","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058482378,"durationMillis":288,"pauseDurationMillis":0,"parentNodes":["36"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/38/wfapi/describe"}},"id":"38","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058482666,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["37"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/39/wfapi/describe"}},"id":"39","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058482682,"durationMillis":291,"pauseDurationMillis":0,"parentNodes":["38"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/40/wfapi/describe"}},"id":"40","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058482973,"durationMillis":13,"pauseDurationMillis":0,"parentNodes":["39"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/41/wfapi/describe"}},"id":"41","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058482986,"durationMillis":273,"pauseDurationMillis":0,"parentNodes":["40"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/44/wfapi/describe"}},"id":"44","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058489506,"durationMillis":12,"pauseDurationMillis":0,"parentNodes":["43"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/45/wfapi/describe"}},"id":"45","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058489518,"durationMillis":313,"pauseDurationMillis":0,"parentNodes":["44"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/46/wfapi/describe"}},"id":"46","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058489831,"durationMillis":14,"pauseDurationMillis":0,"parentNodes":["45"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/47/wfapi/describe"}},"id":"47","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058489845,"durationMillis":292,"pauseDurationMillis":0,"parentNodes":["46"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/48/wfapi/describe"}},"id":"48","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058490137,"durationMillis":20,"pauseDurationMillis":0,"parentNodes":["47"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/49/wfapi/describe"}},"id":"49","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058490157,"durationMillis":270,"pauseDurationMillis":0,"parentNodes":["48"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/52/wfapi/describe"}},"id":"52","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058556017,"durationMillis":21,"pauseDurationMillis":0,"parentNodes":["51"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/53/wfapi/describe"}},"id":"53","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058556038,"durationMillis":1069,"pauseDurationMillis":0,"parentNodes":["52"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/54/wfapi/describe"}},"id":"54","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058557107,"durationMillis":55,"pauseDurationMillis":0,"parentNodes":["53"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/55/wfapi/describe"}},"id":"55","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058557162,"durationMillis":659,"pauseDurationMillis":0,"parentNodes":["54"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/56/wfapi/describe"}},"id":"56","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058557821,"durationMillis":30,"pauseDurationMillis":0,"parentNodes":["55"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/57/wfapi/describe"}},"id":"57","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058557851,"durationMillis":1122,"pauseDurationMillis":0,"parentNodes":["56"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/60/wfapi/describe"}},"id":"60","name":"Print
        Message","execNode":"","status":"SUCCESS","startTimeMillis":1529058559304,"durationMillis":2,"pauseDurationMillis":0,"parentNodes":["59"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/68/wfapi/describe"}},"id":"68","name":"deploying
        the new build","execNode":"","status":"SUCCESS","startTimeMillis":1529058559383,"durationMillis":40901,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/73/wfapi/describe"}},"id":"73","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058559475,"durationMillis":8,"pauseDurationMillis":0,"parentNodes":["72"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/74/wfapi/describe"}},"id":"74","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058559483,"durationMillis":52,"pauseDurationMillis":0,"parentNodes":["73"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/75/wfapi/describe"}},"id":"75","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058559535,"durationMillis":31,"pauseDurationMillis":0,"parentNodes":["74"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/76/wfapi/describe"}},"id":"76","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058559566,"durationMillis":617,"pauseDurationMillis":0,"parentNodes":["75"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/77/wfapi/describe"}},"id":"77","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058560183,"durationMillis":28,"pauseDurationMillis":0,"parentNodes":["76"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/78/wfapi/describe"}},"id":"78","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058560211,"durationMillis":40007,"pauseDurationMillis":0,"parentNodes":["77"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/86/wfapi/describe"}},"id":"86","name":"promotionCheck","execNode":"","status":"SUCCESS","startTimeMillis":1529058600327,"durationMillis":8905,"pauseDurationMillis":7197,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/91/wfapi/describe"}},"id":"91","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058600434,"durationMillis":23,"pauseDurationMillis":0,"parentNodes":["90"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/92/wfapi/describe"}},"id":"92","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058600457,"durationMillis":104,"pauseDurationMillis":0,"parentNodes":["91"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/93/wfapi/describe"}},"id":"93","name":"Wait
        for interactive input","execNode":"","status":"SUCCESS","startTimeMillis":1529058600561,"durationMillis":7312,"pauseDurationMillis":7197,"parentNodes":["92"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/94/wfapi/describe"}},"id":"94","name":"Read
        file from workspace","execNode":"","status":"SUCCESS","startTimeMillis":1529058607873,"durationMillis":47,"pauseDurationMillis":0,"parentNodes":["93"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/95/wfapi/describe"}},"id":"95","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058607920,"durationMillis":1209,"pauseDurationMillis":0,"parentNodes":["94"]}]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/103/wfapi/describe"}},"id":"103","name":"nowDeployingToUAT","execNode":"","status":"SUCCESS","startTimeMillis":1529058609264,"durationMillis":198,"pauseDurationMillis":0,"stageFlowNodes":[{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/108/wfapi/describe"}},"id":"108","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058609372,"durationMillis":16,"pauseDurationMillis":0,"parentNodes":["107"]},{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/3/execution/node/109/wfapi/describe"}},"id":"109","name":"Internal
        utility function for OpenShift DSL","execNode":"","status":"SUCCESS","startTimeMillis":1529058609388,"durationMillis":26,"pauseDurationMillis":0,"parentNodes":["108"]}]}]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-168
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.verbose()\n                        openshift.withProject('fisdemo')
          {\n                            \n                           // def build
          = openshift.startBuild(\"fisgateway-service\", \"--wait\")\n                           \n
          \                              \n                            //def targetBuildConfig
          = openshift.selector( \"bc\", \"fisgateway-service\" )\n                            def
          targetBuild = openshift.startBuild(\"fisgateway-service\")\n              \n
          \                           echo 'Waiting for build to be created...'\n
          \                           targetBuild.watch\n                            {\n
          \                               return it.count() > 0\n                            }\n
          \                           echo 'Build created..'\n              \n                            targetBuild.watch\n
          \                           {\n                                if( it.count()
          == 0 ) \n                                {\n                                    echo
          \"No builds are currently active...\"\n                                    return
          false\n                                }\n                \n                                def
          buildComplete = true\n                \n                                it.withEach\n
          \                               {\n                                    def
          individualBuild = it.object()\n                                    if( it.object().status.phase
          != \"Complete\" ) buildComplete = false\n                                }\n
          \               \n                                return buildComplete\n
          \                           } \n              \n                            echo
          \"Build completed...\"\n                            \n                        }\n
          \                   }\n                }\n            }\n        }\n        \n
          \       stage ('deploying the new build') {\n            steps {\n                script
          {\n                    openshift.withCluster() {\n                        openshift.withProject('fisdemo')
          {\n                                \n                            def deploymentConfig
          = openshift.selector(\"dc\", \"fisgateway-service\")\n                            \n
          \                           def rm = deploymentConfig.rollout()\n                            \n
          \                           //Rollout latest deployment\n                            rm.latest()\n
          \                           \n                            //Check Rollout
          status - blocks and waits for rollout to complete\n                            rm.status()\n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('promotionCheck')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                           input \"Promote to UAT?\"\n                            \n
          \                           openshift.tag(\"fisdemo/fisgateway-service:latest\",
          \"fisdemo/fisgateway-service:uatready\")\n                                \n
          \                           \n                        }   \n                    }\n
          \               }\n            }\n        }\n        stage ('nowDeployingToUAT')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                                \n
          \                          \n                                \n                            \n
          \                       }   \n                    }\n                }\n
          \           }\n        } \n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: Build
  metadata:
    annotations:
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.number: "73"
      openshift.io/jenkins-build-uri: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/48/
      openshift.io/jenkins-console-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/48/console
      openshift.io/jenkins-log-url: https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/48/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"https://jenkins-fisdemocicd.apps.demolab.local/job/fisdemocicd-uat-pipeline/48/wfapi/describe"},"changesets":null,"pendingInputActions":null,"nextPendingInputAction":null,"artifacts":null},"id":"48","name":"#48","status":"NOT_EXECUTED","startTimeMillis":1518698625352,"endTimeMillis":0,"durationMillis":0,"queueDurationMillis":0,"pauseDurationMillis":0,"stages":[]}'
    creationTimestamp: null
    labels:
      app: pipeline-uat
      buildconfig: uat-pipeline
      name: uat-pipeline
      openshift.io/build-config.name: uat-pipeline
      openshift.io/build.start-policy: Serial
      template: pipeline-uat
    name: uat-pipeline-73
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: uat-pipeline
      uid: 811eafc1-0c2e-11e8-8448-52540064f8a5
  spec:
    nodeSelector: null
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        jenkinsfile: "pipeline {\n    agent none\n    stages {\n        stage ('build')
          {\n            steps {\n                script {\n                    openshift.withCluster()
          {\n                        openshift.withProject('fisdemo') {\n                            \n
          \                           // Get Build configuration for fisgateway service\n
          \                           def fisgatewaybuild = openshift.selector('bc',
          'fisgateway-service')\n                            \n                            //
          Start a new build, pulling the source from git\n                            \n
          \                           //sh \"oc start-build fisgateway-service -n
          fisdemo\"\n                            try {\n                                def
          build = fisgatewaybuild.startBuild('-n fisdemo ')\n                                \n
          \                               def fb = openshift.selector('describe',
          'bc', 'fisgateway-service')\n                                echo \"${fb}\"\n
          \                               //Watch the build until it is complete,
          before moving on\n                                //timeout (8) {\n                                //
          \   build.watch {\n                                        \n                                //
          \       echo \"Status : ${it.object().status}\"\n                                //
          \       return (it.object().status.phase == \"Complete\")\n                                    \n
          \                               //    } \n                                }\n
          \                           }\n                            catch (e) {\n
          \                               echo \"Error: ${e}\"\n                            }
          \n                            \n                           // timeout (6)
          { //Timeout the build after 10 minutes\n                            \n                                //Watch
          the build until it is complete, before moving on\n                             /*
          \  build.watch {\n                                    echo \"Status : ${it.object().status.phase}\"\n
          \                                   return (it.object().status.phase ==
          \"Complete\")\n                                    //return (build.status()
          == \"Complete\")\n                               } */\n                                \n
          \                          // }\n                            \n                            \n
          \                           \n                        }\n                    }\n
          \               }\n            }\n        }\n    }\n}\n\n\n\n\n//openshiftBuild(namespace:
          \"fisdemo\", buildConfig: \"fisgateway-service\", showBuildLogs: \"true\")\n
          \           \n    \n/*node('maven') { \n  stage('build') { \n    print 'build'\n
          \    openshiftBuild(namespace: \"fisdemo\", buildConfig: \"fisgateway-service\",
          showBuildLogs: \"true\")\n  }           \n  stage('staging') {\n    print
          'stage' \n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service\")\n  } \n  stage ('promotionCheck') { \n      def
          userInput = input( id: \"userInput\", message: \"Promote to UAT?\", parameters:
          [ [$class: \"TextParameterDefinition\", defaultValue: \"Comments?\", description:
          \"comments\", name: \"comments\"] ])  \n      print 'promotionCheck' \n
          \ \t\topenshiftTag(namespace: \"fisdemo\", sourceStream: \"fisgateway-service\",
          \ sourceTag: \"latest\", destinationNamespace: \"fisdemo\", destinationStream:
          \"fisgateway-service\", destinationTag: \"uatready\")   \n  } \n  \n  stage('UAT')
          { \n    print 'UAT'\n    openshiftDeploy(namespace: \"fisdemo\", deploymentConfig:
          \"fisgateway-service-uat\")\n\t}  \n} */"
      type: JenkinsPipeline
    triggeredBy:
    - message: Manually triggered
  status:
    config:
      name: uat-pipeline
    output: {}
    phase: New
- apiVersion: v1
  kind: ImageStream
  metadata:
    creationTimestamp: null
    generation: 1
    labels:
      group: dub
      project: dublindemo2
      provider: fabric8
      version: 0.0.1-SNAPSHOT
    name: dublindemo2
  spec:
    lookupPolicy:
      local: false
  status:
    dockerImageRepository: ""
- apiVersion: v1
  kind: ImageStream
  metadata:
    annotations:
      openshift.io/image.dockerRepositoryCheck: 2018-04-25T14:51:26Z
    creationTimestamp: null
    generation: 3
    labels:
      app: jenkins-2-rhel7
    name: jenkins-2-rhel7
  spec:
    lookupPolicy:
      local: false
    tags:
    - annotations:
        openshift.io/generated-by: OpenShiftWebConsole
        openshift.io/imported-from: registry.access.redhat.com/openshift3/jenkins-2-rhel7
      from:
        kind: DockerImage
        name: docker-registry.default.svc:5000/fisdemocicd/jenkins-2-rhel7:latest
      generation: 3
      importPolicy: {}
      name: latest
      referencePolicy:
        type: Source
  status:
    dockerImageRepository: ""
- apiVersion: v1
  kind: DeploymentConfig
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      template.alpha.openshift.io/wait-for-ready: "true"
    creationTimestamp: null
    generation: 1
    labels:
      app: jenkins-ephemeral
      template: jenkins-ephemeral-template
    name: jenkins
  spec:
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      name: jenkins
    strategy:
      activeDeadlineSeconds: 21600
      recreateParams:
        timeoutSeconds: 600
      resources: {}
      type: Recreate
    template:
      metadata:
        annotations:
          openshift.io/generated-by: OpenShiftNewApp
        creationTimestamp: null
        labels:
          app: jenkins-ephemeral
          name: jenkins
      spec:
        containers:
        - env:
          - name: OPENSHIFT_ENABLE_OAUTH
            value: "true"
          - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
            value: "true"
          - name: KUBERNETES_MASTER
            value: https://kubernetes.default:443
          - name: KUBERNETES_TRUST_CERTIFICATES
            value: "true"
          - name: JENKINS_SERVICE_NAME
            value: jenkins
          - name: JNLP_SERVICE_NAME
            value: jenkins-jnlp
          image: registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 30
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 420
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          name: jenkins
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 3
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              memory: 512Mi
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/lib/jenkins
            name: jenkins-data
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: jenkins
        serviceAccountName: jenkins
        terminationGracePeriodSeconds: 30
        volumes:
        - emptyDir: {}
          name: jenkins-data
    test: false
    triggers:
    - imageChangeParams:
        automatic: true
        containerNames:
        - jenkins
        from:
          kind: ImageStreamTag
          name: jenkins-2-rhel7:latest
          namespace: fisdemocicd
      type: ImageChange
    - type: ConfigChange
  status:
    availableReplicas: 0
    latestVersion: 0
    observedGeneration: 0
    replicas: 0
    unavailableReplicas: 0
    updatedReplicas: 0
- apiVersion: v1
  kind: Route
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      openshift.io/host.generated: "true"
      template.openshift.io/expose-uri: http://{.spec.host}{.spec.path}
    creationTimestamp: null
    labels:
      app: jenkins-ephemeral
      template: jenkins-ephemeral-template
    name: jenkins
  spec:
    host: jenkins-fisdemocicd.apps.demolab.local
    tls:
      insecureEdgeTerminationPolicy: Redirect
      termination: edge
    to:
      kind: Service
      name: jenkins
      weight: 100
    wildcardPolicy: None
  status:
    ingress:
    - conditions:
      - lastTransitionTime: 2018-02-07T17:44:10Z
        status: "True"
        type: Admitted
      host: jenkins-fisdemocicd.apps.demolab.local
      routerName: router
      wildcardPolicy: None
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      kubernetes.io/created-by: |
        {"kind":"SerializedReference","apiVersion":"v1","reference":{"kind":"ReplicationController","namespace":"fisdemocicd","name":"jenkins-29","uid":"bb5531a4-6fe4-11e8-9fd0-525400f31c93","apiVersion":"v1","resourceVersion":"406059385"}}
      openshift.io/deployment-config.latest-version: "29"
      openshift.io/deployment-config.name: jenkins
      openshift.io/deployment.name: jenkins-29
      openshift.io/generated-by: OpenShiftNewApp
      openshift.io/scc: restricted
    creationTimestamp: null
    generateName: jenkins-29-
    labels:
      app: jenkins-ephemeral
      deployment: jenkins-29
      deploymentconfig: jenkins
      name: jenkins
    ownerReferences:
    - apiVersion: v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicationController
      name: jenkins-29
      uid: bb5531a4-6fe4-11e8-9fd0-525400f31c93
  spec:
    containers:
    - env:
      - name: OPENSHIFT_ENABLE_OAUTH
        value: "true"
      - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
        value: "true"
      - name: KUBERNETES_MASTER
        value: https://kubernetes.default:443
      - name: KUBERNETES_TRUST_CERTIFICATES
        value: "true"
      - name: JENKINS_SERVICE_NAME
        value: jenkins
      - name: JNLP_SERVICE_NAME
        value: jenkins-jnlp
      image: registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf
      imagePullPolicy: IfNotPresent
      livenessProbe:
        failureThreshold: 30
        httpGet:
          path: /login
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 420
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 3
      name: jenkins
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /login
          port: 8080
          scheme: HTTP
        initialDelaySeconds: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 3
      resources:
        limits:
          memory: 512Mi
        requests:
          memory: 512Mi
      securityContext:
        capabilities:
          drop:
          - KILL
          - MKNOD
          - SETGID
          - SETUID
        privileged: false
        runAsUser: 1000370000
        seLinuxOptions:
          level: s0:c19,c14
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /var/lib/jenkins
        name: jenkins-data
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: jenkins-token-gxklm
        readOnly: true
    dnsPolicy: ClusterFirst
    imagePullSecrets:
    - name: jenkins-dockercfg-6hcvn
    nodeName: ocp-app-2.demolab.local
    nodeSelector:
      purpose: apps
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      fsGroup: 1000370000
      seLinuxOptions:
        level: s0:c19,c14
    serviceAccount: jenkins
    serviceAccountName: jenkins
    terminationGracePeriodSeconds: 30
    volumes:
    - emptyDir: {}
      name: jenkins-data
    - name: jenkins-token-gxklm
      secret:
        defaultMode: 420
        secretName: jenkins-token-gxklm
  status:
    phase: Pending
    qosClass: Burstable
- apiVersion: v1
  kind: ReplicationController
  metadata:
    annotations:
      openshift.io/deployer-pod.completed-at: 2018-06-13 10:11:45 +0000 UTC
      openshift.io/deployer-pod.created-at: 2018-06-13 10:09:19 +0000 UTC
      openshift.io/deployer-pod.name: jenkins-27-deploy
      openshift.io/deployment-config.latest-version: "27"
      openshift.io/deployment-config.name: jenkins
      openshift.io/deployment.phase: Complete
      openshift.io/deployment.replicas: "1"
      openshift.io/deployment.status-reason: manual change
      openshift.io/encoded-deployment-config: |
        {"kind":"DeploymentConfig","apiVersion":"v1","metadata":{"name":"jenkins","namespace":"fisdemocicd","selfLink":"/apis/apps.openshift.io/v1/namespaces/fisdemocicd/deploymentconfigs/jenkins","uid":"80b4d728-0c2e-11e8-8448-52540064f8a5","resourceVersion":"405777350","generation":70,"creationTimestamp":"2018-02-07T17:44:10Z","labels":{"app":"jenkins-ephemeral","template":"jenkins-ephemeral-template"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp","template.alpha.openshift.io/wait-for-ready":"true"}},"spec":{"strategy":{"type":"Recreate","recreateParams":{"timeoutSeconds":600},"resources":{},"activeDeadlineSeconds":21600},"triggers":[{"type":"ImageChange","imageChangeParams":{"automatic":true,"containerNames":["jenkins"],"from":{"kind":"ImageStreamTag","namespace":"fisdemocicd","name":"jenkins-2-rhel7:latest"},"lastTriggeredImage":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf"}},{"type":"ConfigChange"}],"replicas":1,"revisionHistoryLimit":10,"test":false,"selector":{"name":"jenkins"},"template":{"metadata":{"creationTimestamp":null,"labels":{"app":"jenkins-ephemeral","name":"jenkins"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp"}},"spec":{"volumes":[{"name":"jenkins-data","emptyDir":{}}],"containers":[{"name":"jenkins","image":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf","env":[{"name":"OPENSHIFT_ENABLE_OAUTH","value":"true"},{"name":"OPENSHIFT_ENABLE_REDIRECT_PROMPT","value":"true"},{"name":"KUBERNETES_MASTER","value":"https://kubernetes.default:443"},{"name":"KUBERNETES_TRUST_CERTIFICATES","value":"true"},{"name":"JENKINS_SERVICE_NAME","value":"jenkins"},{"name":"JNLP_SERVICE_NAME","value":"jenkins-jnlp"}],"resources":{"limits":{"memory":"512Mi"}},"volumeMounts":[{"name":"jenkins-data","mountPath":"/var/lib/jenkins"}],"livenessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":420,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":30},"readinessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":3,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{},"privileged":false}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"jenkins","serviceAccount":"jenkins","securityContext":{},"schedulerName":"default-scheduler"}}},"status":{"latestVersion":27,"observedGeneration":69,"replicas":1,"updatedReplicas":1,"availableReplicas":1,"unavailableReplicas":0,"details":{"message":"manual change","causes":[{"type":"Manual"}]},"conditions":[{"type":"Available","status":"True","lastUpdateTime":"2018-06-13T09:24:35Z","lastTransitionTime":"2018-06-13T09:24:35Z","message":"Deployment config has minimum availability."},{"type":"Progressing","status":"True","lastUpdateTime":"2018-06-13T09:24:36Z","lastTransitionTime":"2018-06-13T09:24:03Z","reason":"NewReplicationControllerAvailable","message":"replication controller \"jenkins-26\" successfully rolled out"}],"readyReplicas":1}}
    creationTimestamp: null
    generation: 1
    labels:
      app: jenkins-ephemeral
      openshift.io/deployment-config.name: jenkins
      template: jenkins-ephemeral-template
    name: jenkins-27
    ownerReferences:
    - apiVersion: apps.openshift.io/v1
      blockOwnerDeletion: true
      controller: true
      kind: DeploymentConfig
      name: jenkins
      uid: 80b4d728-0c2e-11e8-8448-52540064f8a5
  spec:
    replicas: 0
    selector:
      deployment: jenkins-27
      deploymentconfig: jenkins
      name: jenkins
    template:
      metadata:
        annotations:
          openshift.io/deployment-config.latest-version: "27"
          openshift.io/deployment-config.name: jenkins
          openshift.io/deployment.name: jenkins-27
          openshift.io/generated-by: OpenShiftNewApp
        creationTimestamp: null
        labels:
          app: jenkins-ephemeral
          deployment: jenkins-27
          deploymentconfig: jenkins
          name: jenkins
      spec:
        containers:
        - env:
          - name: OPENSHIFT_ENABLE_OAUTH
            value: "true"
          - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
            value: "true"
          - name: KUBERNETES_MASTER
            value: https://kubernetes.default:443
          - name: KUBERNETES_TRUST_CERTIFICATES
            value: "true"
          - name: JENKINS_SERVICE_NAME
            value: jenkins
          - name: JNLP_SERVICE_NAME
            value: jenkins-jnlp
          image: registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 30
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 420
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          name: jenkins
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 3
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              memory: 512Mi
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/lib/jenkins
            name: jenkins-data
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: jenkins
        serviceAccountName: jenkins
        terminationGracePeriodSeconds: 30
        volumes:
        - emptyDir: {}
          name: jenkins-data
  status:
    replicas: 0
- apiVersion: v1
  kind: ReplicationController
  metadata:
    annotations:
      openshift.io/deployer-pod.completed-at: 2018-06-14 10:05:06 +0000 UTC
      openshift.io/deployer-pod.created-at: 2018-06-14 10:04:26 +0000 UTC
      openshift.io/deployer-pod.name: jenkins-28-deploy
      openshift.io/deployment-config.latest-version: "28"
      openshift.io/deployment-config.name: jenkins
      openshift.io/deployment.phase: Complete
      openshift.io/deployment.replicas: "1"
      openshift.io/deployment.status-reason: manual change
      openshift.io/encoded-deployment-config: |
        {"kind":"DeploymentConfig","apiVersion":"v1","metadata":{"name":"jenkins","namespace":"fisdemocicd","selfLink":"/apis/apps.openshift.io/v1/namespaces/fisdemocicd/deploymentconfigs/jenkins","uid":"80b4d728-0c2e-11e8-8448-52540064f8a5","resourceVersion":"406009426","generation":71,"creationTimestamp":"2018-02-07T17:44:10Z","labels":{"app":"jenkins-ephemeral","template":"jenkins-ephemeral-template"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp","template.alpha.openshift.io/wait-for-ready":"true"}},"spec":{"strategy":{"type":"Recreate","recreateParams":{"timeoutSeconds":600},"resources":{},"activeDeadlineSeconds":21600},"triggers":[{"type":"ImageChange","imageChangeParams":{"automatic":true,"containerNames":["jenkins"],"from":{"kind":"ImageStreamTag","namespace":"fisdemocicd","name":"jenkins-2-rhel7:latest"},"lastTriggeredImage":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf"}},{"type":"ConfigChange"}],"replicas":1,"revisionHistoryLimit":10,"test":false,"selector":{"name":"jenkins"},"template":{"metadata":{"creationTimestamp":null,"labels":{"app":"jenkins-ephemeral","name":"jenkins"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp"}},"spec":{"volumes":[{"name":"jenkins-data","emptyDir":{}}],"containers":[{"name":"jenkins","image":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf","env":[{"name":"OPENSHIFT_ENABLE_OAUTH","value":"true"},{"name":"OPENSHIFT_ENABLE_REDIRECT_PROMPT","value":"true"},{"name":"KUBERNETES_MASTER","value":"https://kubernetes.default:443"},{"name":"KUBERNETES_TRUST_CERTIFICATES","value":"true"},{"name":"JENKINS_SERVICE_NAME","value":"jenkins"},{"name":"JNLP_SERVICE_NAME","value":"jenkins-jnlp"}],"resources":{"limits":{"memory":"512Mi"}},"volumeMounts":[{"name":"jenkins-data","mountPath":"/var/lib/jenkins"}],"livenessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":420,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":30},"readinessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":3,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{},"privileged":false}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"jenkins","serviceAccount":"jenkins","securityContext":{},"schedulerName":"default-scheduler"}}},"status":{"latestVersion":28,"observedGeneration":70,"replicas":1,"updatedReplicas":1,"availableReplicas":1,"unavailableReplicas":0,"details":{"message":"manual change","causes":[{"type":"Manual"}]},"conditions":[{"type":"Available","status":"True","lastUpdateTime":"2018-06-13T10:11:44Z","lastTransitionTime":"2018-06-13T10:11:44Z","message":"Deployment config has minimum availability."},{"type":"Progressing","status":"True","lastUpdateTime":"2018-06-13T10:11:46Z","lastTransitionTime":"2018-06-13T10:10:01Z","reason":"NewReplicationControllerAvailable","message":"replication controller \"jenkins-27\" successfully rolled out"}],"readyReplicas":1}}
    creationTimestamp: null
    generation: 1
    labels:
      app: jenkins-ephemeral
      openshift.io/deployment-config.name: jenkins
      template: jenkins-ephemeral-template
    name: jenkins-28
    ownerReferences:
    - apiVersion: apps.openshift.io/v1
      blockOwnerDeletion: true
      controller: true
      kind: DeploymentConfig
      name: jenkins
      uid: 80b4d728-0c2e-11e8-8448-52540064f8a5
  spec:
    replicas: 0
    selector:
      deployment: jenkins-28
      deploymentconfig: jenkins
      name: jenkins
    template:
      metadata:
        annotations:
          openshift.io/deployment-config.latest-version: "28"
          openshift.io/deployment-config.name: jenkins
          openshift.io/deployment.name: jenkins-28
          openshift.io/generated-by: OpenShiftNewApp
        creationTimestamp: null
        labels:
          app: jenkins-ephemeral
          deployment: jenkins-28
          deploymentconfig: jenkins
          name: jenkins
      spec:
        containers:
        - env:
          - name: OPENSHIFT_ENABLE_OAUTH
            value: "true"
          - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
            value: "true"
          - name: KUBERNETES_MASTER
            value: https://kubernetes.default:443
          - name: KUBERNETES_TRUST_CERTIFICATES
            value: "true"
          - name: JENKINS_SERVICE_NAME
            value: jenkins
          - name: JNLP_SERVICE_NAME
            value: jenkins-jnlp
          image: registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 30
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 420
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          name: jenkins
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 3
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              memory: 512Mi
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/lib/jenkins
            name: jenkins-data
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: jenkins
        serviceAccountName: jenkins
        terminationGracePeriodSeconds: 30
        volumes:
        - emptyDir: {}
          name: jenkins-data
  status:
    replicas: 0
- apiVersion: v1
  kind: ReplicationController
  metadata:
    annotations:
      openshift.io/deployer-pod.completed-at: 2018-06-14 15:09:14 +0000 UTC
      openshift.io/deployer-pod.created-at: 2018-06-14 15:08:02 +0000 UTC
      openshift.io/deployer-pod.name: jenkins-29-deploy
      openshift.io/deployment-config.latest-version: "29"
      openshift.io/deployment-config.name: jenkins
      openshift.io/deployment.phase: Complete
      openshift.io/deployment.replicas: "1"
      openshift.io/deployment.status-reason: manual change
      openshift.io/encoded-deployment-config: |
        {"kind":"DeploymentConfig","apiVersion":"v1","metadata":{"name":"jenkins","namespace":"fisdemocicd","selfLink":"/apis/apps.openshift.io/v1/namespaces/fisdemocicd/deploymentconfigs/jenkins","uid":"80b4d728-0c2e-11e8-8448-52540064f8a5","resourceVersion":"406059274","generation":72,"creationTimestamp":"2018-02-07T17:44:10Z","labels":{"app":"jenkins-ephemeral","template":"jenkins-ephemeral-template"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp","template.alpha.openshift.io/wait-for-ready":"true"}},"spec":{"strategy":{"type":"Recreate","recreateParams":{"timeoutSeconds":600},"resources":{},"activeDeadlineSeconds":21600},"triggers":[{"type":"ImageChange","imageChangeParams":{"automatic":true,"containerNames":["jenkins"],"from":{"kind":"ImageStreamTag","namespace":"fisdemocicd","name":"jenkins-2-rhel7:latest"},"lastTriggeredImage":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf"}},{"type":"ConfigChange"}],"replicas":1,"revisionHistoryLimit":10,"test":false,"selector":{"name":"jenkins"},"template":{"metadata":{"creationTimestamp":null,"labels":{"app":"jenkins-ephemeral","name":"jenkins"},"annotations":{"openshift.io/generated-by":"OpenShiftNewApp"}},"spec":{"volumes":[{"name":"jenkins-data","emptyDir":{}}],"containers":[{"name":"jenkins","image":"registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf","env":[{"name":"OPENSHIFT_ENABLE_OAUTH","value":"true"},{"name":"OPENSHIFT_ENABLE_REDIRECT_PROMPT","value":"true"},{"name":"KUBERNETES_MASTER","value":"https://kubernetes.default:443"},{"name":"KUBERNETES_TRUST_CERTIFICATES","value":"true"},{"name":"JENKINS_SERVICE_NAME","value":"jenkins"},{"name":"JNLP_SERVICE_NAME","value":"jenkins-jnlp"}],"resources":{"limits":{"memory":"512Mi"}},"volumeMounts":[{"name":"jenkins-data","mountPath":"/var/lib/jenkins"}],"livenessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":420,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":30},"readinessProbe":{"httpGet":{"path":"/login","port":8080,"scheme":"HTTP"},"initialDelaySeconds":3,"timeoutSeconds":3,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{},"privileged":false}}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"jenkins","serviceAccount":"jenkins","securityContext":{},"schedulerName":"default-scheduler"}}},"status":{"latestVersion":29,"observedGeneration":71,"replicas":1,"updatedReplicas":1,"availableReplicas":1,"unavailableReplicas":0,"details":{"message":"manual change","causes":[{"type":"Manual"}]},"conditions":[{"type":"Available","status":"True","lastUpdateTime":"2018-06-14T10:05:06Z","lastTransitionTime":"2018-06-14T10:05:06Z","message":"Deployment config has minimum availability."},{"type":"Progressing","status":"True","lastUpdateTime":"2018-06-14T10:05:08Z","lastTransitionTime":"2018-06-14T10:04:35Z","reason":"NewReplicationControllerAvailable","message":"replication controller \"jenkins-28\" successfully rolled out"}],"readyReplicas":1}}
    creationTimestamp: null
    generation: 1
    labels:
      app: jenkins-ephemeral
      openshift.io/deployment-config.name: jenkins
      template: jenkins-ephemeral-template
    name: jenkins-29
    ownerReferences:
    - apiVersion: apps.openshift.io/v1
      blockOwnerDeletion: true
      controller: true
      kind: DeploymentConfig
      name: jenkins
      uid: 80b4d728-0c2e-11e8-8448-52540064f8a5
  spec:
    replicas: 1
    selector:
      deployment: jenkins-29
      deploymentconfig: jenkins
      name: jenkins
    template:
      metadata:
        annotations:
          openshift.io/deployment-config.latest-version: "29"
          openshift.io/deployment-config.name: jenkins
          openshift.io/deployment.name: jenkins-29
          openshift.io/generated-by: OpenShiftNewApp
        creationTimestamp: null
        labels:
          app: jenkins-ephemeral
          deployment: jenkins-29
          deploymentconfig: jenkins
          name: jenkins
      spec:
        containers:
        - env:
          - name: OPENSHIFT_ENABLE_OAUTH
            value: "true"
          - name: OPENSHIFT_ENABLE_REDIRECT_PROMPT
            value: "true"
          - name: KUBERNETES_MASTER
            value: https://kubernetes.default:443
          - name: KUBERNETES_TRUST_CERTIFICATES
            value: "true"
          - name: JENKINS_SERVICE_NAME
            value: jenkins
          - name: JNLP_SERVICE_NAME
            value: jenkins-jnlp
          image: registry.access.redhat.com/openshift3/jenkins-2-rhel7@sha256:9b11753055e5e0247aa638aadf68509cb83eb7890378c326f57df3562e7f2cdf
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 30
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 420
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          name: jenkins
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /login
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 3
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              memory: 512Mi
          securityContext:
            capabilities: {}
            privileged: false
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/lib/jenkins
            name: jenkins-data
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: jenkins
        serviceAccountName: jenkins
        terminationGracePeriodSeconds: 30
        volumes:
        - emptyDir: {}
          name: jenkins-data
  status:
    replicas: 0
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
      service.alpha.openshift.io/dependencies: '[{"name": "jenkins-jnlp", "namespace":
        "", "kind": "Service"}]'
      service.openshift.io/infrastructure: "true"
    creationTimestamp: null
    labels:
      app: jenkins-ephemeral
      template: jenkins-ephemeral-template
    name: jenkins
  spec:
    ports:
    - name: web
      port: 80
      protocol: TCP
      targetPort: 8080
    selector:
      name: jenkins
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftWebConsole
    creationTimestamp: null
    labels:
      app: jenkins-2-rhel7
    name: jenkins-2-rhel7
  spec:
    ports:
    - name: 8080-tcp
      port: 8080
      protocol: TCP
      targetPort: 8080
    - name: 50000-tcp
      port: 50000
      protocol: TCP
      targetPort: 50000
    selector:
      deploymentconfig: jenkins-2-rhel7
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      openshift.io/generated-by: OpenShiftNewApp
    creationTimestamp: null
    labels:
      app: jenkins-ephemeral
      template: jenkins-ephemeral-template
    name: jenkins-jnlp
  spec:
    ports:
    - name: agent
      port: 50000
      protocol: TCP
      targetPort: 50000
    selector:
      name: jenkins
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
